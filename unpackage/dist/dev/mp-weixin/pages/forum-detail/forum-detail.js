(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/forum-detail/forum-detail"],{511:function(e,t,n){"use strict";(function(e,t){var r=n(4);n(26);r(n(25));var a=r(n(512));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n(1)["default"],n(2)["createPage"])},512:function(e,t,n){"use strict";n.r(t);var r=n(513),a=n(515);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n(517);var u,c=n(32),o=Object(c["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,"18f25b26",null,!1,r["components"],u);o.options.__file="pages/forum-detail/forum-detail.vue",t["default"]=o.exports},513:function(e,t,n){"use strict";n.r(t);var r=n(514);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},514:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return u})),n.d(t,"recyclableRender",(function(){return i})),n.d(t,"components",(function(){return r}));var a=function(){var e=this,t=e.$createElement;e._self._c},i=!1,u=[];a._withStripped=!0},515:function(e,t,n){"use strict";n.r(t);var r=n(516),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},516:function(e,t,n){"use strict";(function(e){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(57)),i=r(n(59)),u=function(){n.e("components/forum-reply/forum-reply").then(function(){return resolve(n(738))}.bind(null,n)).catch(n.oe)},c={components:{userReply:u},data:function(){return{commentData:[],forum:{},id:"",likeType:!1,likeForm:{}}},computed:{baseUrl:function(){return this.$base.url},userid:function(){return e.getStorageSync("appUserid")}},onLoad:function(e){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.id=e.id,n.next=3,t.$api.forumDetail(e.id);case 3:r=n.sent,r.data.childs=t.changeContent(r.data.childs),t.commentData=r.data.childs,r.data.content=r.data.content.replace(/img src/gi,'img style="width:100%;" src'),t.forum=r.data,t.getLike();case 9:case"end":return n.stop()}}),n)})))()},onShow:function(){var e=this;return(0,i.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.forumDetail(e.id);case 2:n=t.sent,n.data.childs=e.changeContent(n.data.childs),e.commentData=n.data.childs,e.forum=n.data,n.data.content=n.data.content.replace(/img src/gi,'img style="width:100%;" src');case 7:case"end":return t.stop()}}),t)})))()},methods:{getLike:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$api.list("storeup",{page:1,limit:1,type:21,userid:e.getStorageSync("appUserid"),refid:t.id,tablename:"forum"});case 2:r=n.sent,r.data.list.length?(t.likeType=!0,t.likeForm=r.data.list[0]):t.likeType=!1;case 4:case"end":return n.stop()}}),n)})))()},likeClick:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t,!t.likeType){n.next=5;break}e.showModal({title:"提示",content:"是否取消点赞？",success:function(e){return(0,i.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.confirm){t.next=5;break}return t.next=3,r.$api.del("storeup",JSON.stringify([r.likeForm.id]));case 3:r.$utils.msg("取消成功"),r.getLike();case 5:case"end":return t.stop()}}),t)})))()}}),n.next=9;break;case 5:return n.next=7,r.$api.add("storeup",{userid:e.getStorageSync("appUserid"),refid:t.id,type:21,name:t.forum.title,picture:"",tablename:"forum"});case 7:t.$utils.msg("点赞成功"),t.getLike();case 9:case"end":return n.stop()}}),n)})))()},changeContent:function(e){return e&&(e=t(e)),e;function t(e){for(var n in e)e[n].content=e[n].content.replace(/img src/gi,'img style="width:100%;" src'),e[n].childs&&(e[n].childs=t(e[n].childs));return e}},onReplyTap:function(e){this.$utils.jump("../forum-reply/forum-reply?pid=".concat(e))},delClick:function(t){var n=this;e.showModal({title:"提示",content:"是否删除此评论？",success:function(e){return(0,i.default)(a.default.mark((function r(){return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.confirm){r.next=5;break}return r.next=3,n.$api.del("forum",JSON.stringify([t]));case 3:n.$utils.msg("删除成功"),setTimeout((0,i.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.$api.forumDetail(n.id);case 2:t=e.sent,t.data.childs=n.changeContent(t.data.childs),n.commentData=t.data.childs;case 5:case"end":return e.stop()}}),e)}))),1500);case 5:case"end":return r.stop()}}),r)})))()}})}}};t.default=c}).call(this,n(2)["default"])},517:function(e,t,n){"use strict";n.r(t);var r=n(518),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},518:function(e,t,n){}},[[511,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/forum-detail/forum-detail.js.map