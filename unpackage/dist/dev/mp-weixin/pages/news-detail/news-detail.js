(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/news-detail/news-detail"],{111:function(e,t,n){"use strict";(function(e,t){var r=n(4);n(26);r(n(25));var a=r(n(112));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n(1)["default"],n(2)["createPage"])},112:function(e,t,n){"use strict";n.r(t);var r=n(113),a=n(115);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n(117);var s,u=n(32),c=Object(u["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,"69e22b1e",null,!1,r["components"],s);c.options.__file="pages/news-detail/news-detail.vue",t["default"]=c.exports},113:function(e,t,n){"use strict";n.r(t);var r=n(114);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},114:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return s})),n.d(t,"recyclableRender",(function(){return i})),n.d(t,"components",(function(){return r}));var a=function(){var e=this,t=e.$createElement;e._self._c},i=!1,s=[];a._withStripped=!0},115:function(e,t,n){"use strict";n.r(t);var r=n(116),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},116:function(e,t,n){"use strict";(function(e){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(57)),i=r(n(59)),s={data:function(){return{detail:{},id:"",likeType:!1,likeForm:{},collectType:!1,collectForm:{},allList:[],currentIndex:0,hotList:[],recommendList:[]}},onLoad:function(e){var t=this;return(0,i.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.id=e.id,t.getInfo(),t.getHotList(),t.getRecommendList();case 4:case"end":return n.stop()}}),n)})))()},computed:{baseUrl:function(){return this.$base.url},userid:function(){return e.getStorageSync("appUserid")}},methods:{getInfo:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r,i;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$api.info("news",t.id);case 2:return r=n.sent,r.data.content=r.data.content.replace(/<img/g,'<img style="width: 100%;"'),t.detail=r.data,e.pageScrollTo({scrollTop:0,duration:100}),t.getLike(),t.getCollect(),n.next=10,t.$api.list("news",{page:1,limit:100,sort:"addtime",order:"desc"});case 10:r=n.sent,n.t0=a.default.keys(r.data.list);case 12:if((n.t1=n.t0()).done){n.next=19;break}if(i=n.t1.value,r.data.list[i].id!=t.id){n.next=17;break}return t.currentIndex=Number(i),n.abrupt("break",19);case 17:n.next=12;break;case 19:t.allList=r.data.list;case 20:case"end":return n.stop()}}),n)})))()},getLike:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$api.list("storeup",{page:1,limit:1,type:21,userid:e.getStorageSync("appUserid"),refid:t.id,tablename:"news"});case 2:r=n.sent,r.data.list.length?(t.likeType=!0,t.likeForm=r.data.list[0]):(t.likeType=!1,t.likeForm={});case 4:case"end":return n.stop()}}),n)})))()},getHotList:function(){var e=this;return(0,i.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.recommend("news",{page:1,limit:4,sort:"addtime",order:"desc"});case 2:n=t.sent,e.hotList=n.data.list;case 4:case"end":return t.stop()}}),t)})))()},getRecommendList:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.getStorageSync("appUserid")){n.next=6;break}return n.next=3,t.$api.recommend2("news",{page:1,limit:4,sort:"addtime",order:"desc"});case 3:r=n.sent,n.next=9;break;case 6:return n.next=8,t.$api.recommend("news",{page:1,limit:4,sort:"addtime",order:"desc"});case 8:r=n.sent;case 9:t.recommendList=r.data.list;case 10:case"end":return n.stop()}}),n)})))()},prepDetailClick:function(){if(0==this.currentIndex)return this.$message.error("已经是第一篇了"),!1;this.currentIndex--,this.id=this.allList[this.currentIndex].id,this.getInfo()},nextDetailClick:function(){if(this.currentIndex==this.allList.length-1)return this.$message.error("已经是最后一篇了"),!1;this.currentIndex++,this.id=this.allList[this.currentIndex].id,this.getInfo()},toDetail:function(e){this.id=e,this.getInfo()},getCollect:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$api.list("storeup",{page:1,limit:1,type:1,userid:e.getStorageSync("appUserid"),refid:t.id,tablename:"news"});case 2:r=n.sent,r.data.list.length?(t.collectType=!0,t.collectForm=r.data.list[0]):(t.collectType=!1,t.collectForm={});case 4:case"end":return n.stop()}}),n)})))()},likeClick:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t,!t.likeType){n.next=5;break}e.showModal({title:"提示",content:"是否取消点赞？",success:function(e){return(0,i.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.confirm){t.next=8;break}return t.next=3,r.$api.del("storeup",JSON.stringify([r.likeForm.id]));case 3:return r.$utils.msg("取消成功"),r.detail.thumbsupnum--,t.next=7,r.$api.update("news",r.detail);case 7:r.getLike();case 8:case"end":return t.stop()}}),t)})))()}}),n.next=12;break;case 5:return n.next=7,r.$api.add("storeup",{userid:e.getStorageSync("appUserid"),refid:t.id,type:21,name:t.detail.title,picture:t.detail.picture,tablename:"news"});case 7:return t.$utils.msg("点赞成功"),r.detail.thumbsupnum++,n.next=11,r.$api.update("news",r.detail);case 11:t.getLike();case 12:case"end":return n.stop()}}),n)})))()},collectClick:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t,!t.collectType){n.next=5;break}e.showModal({title:"提示",content:"是否取消收藏？",success:function(e){return(0,i.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.confirm){t.next=8;break}return t.next=3,r.$api.del("storeup",JSON.stringify([r.collectForm.id]));case 3:return r.$utils.msg("取消成功"),r.detail.storeupnum--,t.next=7,r.$api.update("news",r.detail);case 7:r.getCollect();case 8:case"end":return t.stop()}}),t)})))()}}),n.next=12;break;case 5:return n.next=7,r.$api.add("storeup",{userid:e.getStorageSync("appUserid"),refid:t.id,type:1,name:t.detail.title,picture:t.detail.picture,tablename:"news"});case 7:return t.$utils.msg("收藏成功"),r.detail.storeupnum++,n.next=11,r.$api.update("news",r.detail);case 11:t.getCollect();case 12:case"end":return n.stop()}}),n)})))()}}};t.default=s}).call(this,n(2)["default"])},117:function(e,t,n){"use strict";n.r(t);var r=n(118),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},118:function(e,t,n){}},[[111,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/news-detail/news-detail.js.map